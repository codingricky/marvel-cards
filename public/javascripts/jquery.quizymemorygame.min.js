if(!Array.indexOf){Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++){if(this[t]==e){return t}}return-1}}(function(e){var t="";var n={};var r={init:function(r){t=e(this).html();n=r;var i=e.extend({},e.fn.quizyMemoryGame.defaults,r);var s=e(this).children("ul").children("li").length;var o=new Array;var u=new Array;var a=new Array;var f="quizy-mg-item";var l="";var c=-1;var h=0;var p=0;var d=0;var v=0;var m;var g=i.openDelay;var y=i.itemWidth;var b=i.itemHeight;var w=i.itemsMargin;var E=Math.ceil(s/i.colCount);var S=function(){if(p==0)m=setInterval(L,1e3);p++;var t=e(this).attr("id");var n=parseInt(t.substring(f.length,t.length));var r=u[n];x(e(this));N(e(this),n);if(h==0){h++;l=r;c=t}else if(h==1){h=0;if(r==l){k("correct");x(e("."+r));o.push(t);o.push(c);d++;if(d==s/2){clearInterval(m);if(i.gameSummary){e("div#quizy-game-summary").children("div#gs-column2").html(v+"<br>"+i.textSummaryTime);e("div#quizy-game-summary").children("div#gs-column3").html(p+"<br>"+i.textSummaryClicks);e("div#quizy-game-summary").delay(2e3).fadeIn(1e3)}if(i.onFinishCall!=""){i.onFinishCall({clicks:p,time:v})}}}else{k("wrong");x(e("div."+f));C(e("div#"+c));C(e(this));setTimeout(function(){e("."+f).each(function(){var t=e(this).attr("id");if(o.indexOf(t)==-1){T(e(this))}})},g+i.animSpeed+250)}}};var x=function(e){e.unbind("click");e.css("cursor","default")};var T=function(e){e.bind("click",S);e.css("cursor","pointer")};var N=function(t,n){var r=t.children("div.quizy-mg-item-top").attr("id");switch(i.animType){default:case"fade":A(t,n);e("#"+r).fadeOut(i.animSpeed);break;case"flip":t.flip({direction:i.flipAnim,speed:i.animSpeed,content:t.children("div.quizy-mg-item-bottom"),color:"#777",onEnd:function(){O(t,n)}});break;case"scroll":A(t,n);e("#"+r).animate({height:"toggle",opacity:.3},i.animSpeed);break}};var C=function(t){var n=t.children("div.quizy-mg-item-top").attr("id");switch(i.animType){default:case"fade":e("#"+n).delay(g).fadeIn(i.animSpeed,function(){M(t)});break;case"flip":setTimeout(function(){t.revertFlip()},g);setTimeout(function(){M(t)},g+i.animSpeed*4);break;case"scroll":e("#"+n).delay(g).animate({height:"toggle",opacity:1},i.animSpeed,function(){M(t)});break}};var k=function(t){if(i.resultIcons){var n;var r=Math.round(g/3);if(t=="wrong"){n=e("div#quizy-mg-msgwrong")}else if(t=="correct"){n=e("div#quizy-mg-msgcorrect")}n.delay(r).fadeIn(r/2).delay(r/2).hide("explode",r/2)}};var L=function(){v++};var A=function(e,t){e.children(".quizy-mg-item-bottom").children(".mgcard-show").html(a[t])};var O=function(e,t){e.children(".mgcard-show").html(a[t])};var M=function(e){e.children(".quizy-mg-item-bottom").children(".mgcard-show").html("")};e(this).children("ul").hide();e(this).css({height:E*(b+w)+"px"});var _=Array();for(var D=0;D<s;D++){a[D]="";_.push(D)}var P=0;while(P<s){var H=Math.floor(Math.random()*_.length);var D=_[H];_.splice(H,1);var B=e(this).children("ul").children("li").eq(D);var j=(P+i.colCount)%i.colCount;var F=Math.floor(P/i.colCount);var I=j*(y+w);var q=F*(b+w);a[D]=B.html();e(this).append('<div id="'+f+D+'" class="'+f+'" style="width:'+y+"px; height:"+b+"px; left:"+I+"px; top:"+q+'px">'+'<div class="quizy-mg-item-bottom"><div class="mgcard-show">'+'</div></div><div id="quizy-mg-item-top'+D+'" class="quizy-mg-item-top" style="width:'+y+"px; height:"+b+'px;"></div></div>');P++;u[D]=B.attr("class")}e(this).children("ul").remove();if(i.resultIcons){e(this).append('<div id="quizy-mg-msgwrong"'+' class="quizy-mg-notification-fly quizy-mg-notification-fly-neg"></div>'+'<div id="quizy-mg-msgcorrect" class="quizy-mg-notification-fly '+' quizy-mg-notification-fly-pos"></div>');var R=e(this).width()/2-e("div.quizy-mg-notification-fly").width()/2;var U=e(this).height()/2-e("div.quizy-mg-notification-fly").height()/2-i.itemsMargin/2;e("div.quizy-mg-notification-fly").css({top:U+"px",left:R+"px"})}if(i.gameSummary){var z=e(this);z.append('<div id="quizy-game-summary"><div class="gs-column" id="gs-column1">'+i.textSummaryTitle+'</div><div class="gs-column" id="gs-column2"></div>'+'<div class="gs-column" id="gs-column3"></div>'+'<div class="quizy-game-clear"></div></div>');var R=z.width()/2-e("div#quizy-game-summary").width()/2;var U=z.height()/2-e("div#quizy-game-summary").height()/2-i.itemsMargin/2;e("div#quizy-game-summary").css({top:U+"px",left:R+"px"});if(i.replayButton){e("#quizy-game-summary").append('<div id="gs-replaybut">'+i.replayButtonText+"</div>")}e("#quizy-game-summary").append('<div id="gs-closebut">'+i.closeButtonText+"</div>");e("div#gs-closebut").click(function(){e(this).parent().fadeOut()});e("div#gs-replaybut").click(function(){z.quizyMemoryGame("restart")})}e(".quizy-mg-item").click(S)},destroy:function(){e(this).empty()},restart:function(){r.destroy.apply(this);e(this).append(t);r.init.call(this,n)}};e.fn.quizyMemoryGame=function(t){if(r[t]){return r[t].apply(this,arguments)}else if(typeof t==="object"||!t){return r.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.tooltip")}};e.fn.quizyMemoryGame.defaults={itemWidth:156,itemHeight:156,itemsMargin:10,colCount:4,animType:"scroll",animSpeed:250,openDelay:2500,flipAnim:"rl",resultIcons:true,gameSummary:true,textSummaryTitle:"Your game summary",replayButton:true,replayButtonText:"Replay",closeButtonText:"Close",textSummaryClicks:"clicks",textSummaryTime:"seconds",onFinishCall:""}})(jQuery)